<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Inline - META</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="../assets/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../assets/bower_components/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="../assets/bower_components/Ionicons/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="../assets/dist/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="../assets/dist/css/AdminLTE.min.css">
    <link rel="stylesheet" href="../assets/dist/css/fab4meta.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<body class="layout-top-nav">
    <div class="wrapper main-pg">
        <header class="main-header site-header">
            <nav class="navbar navbar-static-top">
                <div class="col-md-12 col-centered no-padding">
                    <div class="navbar-header">
                        <a href="/" class="navbar-minimal page-title">META</a>
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"><i class="fa fa-bars"></i>
                        </button>
                    </div>
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li>
                                <a href="/"><span class="link-nav link-active"><i class="fa fa-home"></i> Home </span></a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle link-nav" data-toggle="dropdown" ><span class=""><i class="fa fa-bar-chart"></i> Reports </span><span class="caret caret-style"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li>
                                        <a href="/reports?type=cycletime">Fab4 Cycletime</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/reports?type=cycletime-cluster-1">Cluster 1 Cycletime</a>
                                    </li>
                                    <li>
                                        <a href="/reports?type=cycletime-cluster-2">Cluster 2 Cycletime</a>
                                    </li>
                                    <li>
                                        <a href="/reports?type=cycletime-cluster-3">Cluster 3 Cycletime</a>
                                    </li>
                                    <li>
                                        <a href="/reports?type=cycletime-cluster-4">Cluster 4 Cycletime</a>
                                    </li>
                                    <li>
                                        <a href="/reports?type=cycletime-cluster-5">Cluster 5 Cycletime</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/reports?type=daily-binning-per-wafer-supplier">Daily Binning</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/reports?type=hourly-eol-silicon-parameters">Hourly EOL and Silicon Parameters</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/reports?type=equipment-status">WTD Equipment Status</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle link-nav" data-toggle="dropdown" ><span class=""><i class="fa fa-pencil-square-o"></i> Prototype </span><span class="caret caret-style"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li>
                                        <a href="/coa">Certificate of Analysis</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/feed/?type=ndep&filename=ndep.txt">NDEP News Feed</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle link-nav" data-toggle="dropdown"><span class=""></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li>
                                        <a href="/inline"><i class="fa fa-newspaper-o"></i> My inline</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="/logout"><i class="fa fa-sign-out"></i> Logout</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <section class="content feed-area">
                <div class="row">
                    <div class="col-md-5">
                        <p style="color:darkgray; font-weight: 300; margin: 0 0px 10px;">NOXE Quick Change</p>
                        <% if(inline_tools) { %>
                            <% for(let i=0; i<inline_tools.length; i++) { %>
                                <% if(inline_tools[i].noxe) { %>
                                    <button type="button" id="<%= inline_tools[i].name %>" class="btn btn-app" data-toggle="modal" data-target="#<%= inline_tools[i].modalVal %>">
                                        <i class="fa fa-building"></i><%= inline_tools[i].noxe %>
                                    </button>
                                <% } %>
                            <% } %>
                        <% } %>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <p style="color:darkgray; font-weight: 300; margin: 0 0px 10px;">TOXE Quick Change</p>
                        <% if(inline_tools) { %>
                            <% for(let i=0; i<inline_tools.length; i++) { %>
                                <% if(inline_tools[i].toxe) { %>
                                    <button class="btn btn-app" id="<%= inline_tools[i].name %>" data-toggle="modal" data-target="#<%= inline_tools[i].modalVal %>">
                                        <i class="fa fa-building"></i><%= inline_tools[i].toxe %>
                                    </button>
                                <% } %>
                            <% } %>
                        <% } %>
                    </div>
                </div>
                <% if(inline_tools) { %>
                <% for(let i=0; i<inline_tools.length; i++) { %>
                    <% if(inline_tools[i].noxe) { %>
                        <div class="modal modal-default" id="<%= inline_tools[i].modalVal %>">
                            <div class="modal-dialog modal-settings">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                        <h4 class="inline-modal-head">Change current status for <%= (inline_tools[i].noxe).toUpperCase() %></h4>
                                    </div>
                                    <form id="uploadinline<%= inline_tools[i].name %>">
                                        <div class="modal-body">
                                            <input type="hidden" name="inline_name" id="inline_name<%= inline_tools[i].name %>" value="<%= inline_tools[i].name %>">
                                            <%= (inline_tools[i].noxe).toUpperCase() %>
                                            <select name="status" id="status<%= inline_tools[i].name %>">
                                                <option value="5S" selected>Tool 5S</option>
                                                <option value="STANDBY" >Standby</option>
                                            </select>
                                            for 
                                            <select name="duration" id="duration<%= inline_tools[i].name %>">
                                                <option value="5" selected>5</option>
                                                <option value="10">10</option>
                                            </select> 
                                            minutes.
                                        </div>
                                        <div class="modal-footer">
                                            <div id="responseDiv<%= inline_tools[i].name %>">
                                                <!-- response here-->
                                            </div>
                                            <div id="toHideButtonIfSuccess">
                                                <div class="row">
                                                    <div class="col-md-7">
                                                        <div class="signup-sub-link">
                                                        By clicking "Change Status" you indicate and agree that you understand what you're doing.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-5">
                                                        <button type="button" id="cancelinline" class="btn btn-default btn-flat " data-dismiss="modal" aria-label="Close" >Cancel</button>

                                                        <button type="submit" id="submitinline" class="btn btn-danger btn-flat">Change Status</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    <% } else if(inline_tools[i].toxe) { %>
                        <div class="modal modal-default" id="<%= inline_tools[i].modalVal %>">
                            <div class="modal-dialog modal-settings">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                        <h4 class="inline-modal-head">Change current status for <%= (inline_tools[i].toxe).toUpperCase() %></h4>
                                    </div>
                                    <form id="uploadinline<%= inline_tools[i].name %>">
                                        <div class="modal-body">
                                            <input type="hidden" name="inline_name" id="inline_name<%= inline_tools[i].name %>" value="<%= inline_tools[i].name %>">
                                            <%= (inline_tools[i].toxe).toUpperCase() %>
                                            <select name="status" id="status<%= inline_tools[i].name %>">
                                                <option value="5S" selected>Tool 5S</option>
                                                <option value="STANDBY" >Standby</option>
                                            </select>
                                            for 
                                            <select name="duration" id="duration<%= inline_tools[i].name %>">
                                                <option value="5" selected>5</option>
                                                <option value="10">10</option>
                                            </select> 
                                            minutes.
                                        </div>
                                        <div class="modal-footer">
                                            <div id="responseDiv<%= inline_tools[i].name %>">
                                                <!-- response here-->
                                            </div>
                                            <div id="toHideButtonIfSuccess">
                                                <div class="row">
                                                    <div class="col-md-7">
                                                        <div class="signup-sub-link">
                                                        By clicking "Change Status" you indicate and agree that you understand what you're doing.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-5">
                                                        <button type="button" id="cancelinline" class="btn btn-default btn-flat " data-dismiss="modal" aria-label="Close" >Cancel</button>

                                                        <button type="submit" id="submitinline" class="btn btn-danger btn-flat">Change Status</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    <% } %>
                <% } %>
                <% } %>
        </section>
    </div>

<script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
<!-- jQuery 3 -->
<script src="../assets/bower_components/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="../assets/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Socket IO-->
<script src="/socket.io/socket.io.js"></script> 
<!-- Socket IO oh ohh ohhh-->
<script>
    
    $(function(){
        let socket = io.connect('/');
        
        <% if(inline_tools) { %>
            <% for(let i=0; i<inline_tools.length; i++) { %>
                <% if(inline_tools[i].noxe) { %>

                    $('#uploadinline<%= inline_tools[i].name %>').submit(function(){
                        socket.emit('inline-thread', {
                            inline_name: $('#inline_name<%= inline_tools[i].name %>').val(),
                            status: $('#status<%= inline_tools[i].name %>').val(),
                            duration: $('#duration<%= inline_tools[i].name %>').val()
                        });

                        document.getElementById('<%= inline_tools[i].name %>').setAttribute("disabled", 'disabled');
                        $('#<%= inline_tools[i].modalVal %>').modal('toggle');

                        return false;
                        
                    });

                
                <% } else if(inline_tools[i].toxe) { %>
                        
                    $('#uploadinline<%= inline_tools[i].name %>').submit(function(){
                        socket.emit('inline-thread', {
                            inline_name: $('#inline_name<%= inline_tools[i].name %>').val(),
                            status: $('#status<%= inline_tools[i].name %>').val(),
                            duration: $('#duration<%= inline_tools[i].name %>').val()
                        });
                        
                        document.getElementById('<%= inline_tools[i].name %>').setAttribute("disabled", 'disabled');
                        $('#<%= inline_tools[i].modalVal %>').modal('toggle');

                        return false;
                        
                    });

                <% } %>
                
                socket.on('inline-thread-response', function(data){

                    if(data.message.inline_name == '<%= inline_tools[i].name %>'){

                        if(data.message.status_name == 'Status Changed'){

                            document.getElementById('<%= inline_tools[i].name %>').setAttribute("disabled", 'disabled');
                            //localStorage.setItem('<%= inline_tools[i].name %>-button', 'disabled');

                        } else if(data.message.status_name == 'Status Reverted'){

                            document.getElementById('<%= inline_tools[i].name %>').removeAttribute("disabled");
                            //localStorage.setItem('<%= inline_tools[i].name %>-button', '');
                        }

                        console.log(data.message.inline_name , ' - ' , data.message.status_name , ' - ', data.message.status_info, ' - ', data.message.duration, ' - ', ' minutes');

                    }

                });

            <% } %>
        <% } %>

    });

</script>
</body>
</html>
